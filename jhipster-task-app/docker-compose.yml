version: '3'
services:
  jhipster-task-app:
    image: ${DOCKER_HUB_USERNAME}/jhipster-task-app:latest
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=prod,api-docs
      - JHIPSTER_SLEEP=30 # gives time for other services to boot before the application
      - SPRING_DATASOURCE_URL=jdbc:postgresql://postgresql:5432/jhipsterTaskApp
      - SPRING_DATASOURCE_USERNAME=jhipsterTaskApp
      - SPRING_DATASOURCE_PASSWORD=
    depends_on:
      - postgresql

  postgresql:
    image: postgres:14.5
    volumes:
      - ~/volumes/jhipster/jhipsterTaskApp/postgresql/:/var/lib/postgresql/data/
    environment:
      - POSTGRES_USER=jhipsterTaskApp
      - POSTGRES_PASSWORD=
      - POSTGRES_HOST_AUTH_METHOD=trust
    ports:
      - "5432:5432"
